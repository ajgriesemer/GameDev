
<html>
<head>
    <script type="text/javascript"
            src="https://www.airconsole.com/api/airconsole-1.3.0.js"></script>
    <script type="text/javascript">
    navigator.vibrate = (navigator.vibrate ||
                         navigator.webkitVibrate ||
                         navigator.mozVibrate ||
                         navigator.msVibrate);

    var airconsole;
    var isPlayerReady;
    var playerTeam;

    /**
     * Sets up the communication to the screen.
     */
    function init() {
      isPlayerReady = false;
      airconsole = new AirConsole({ "orientation": "landscape" });
      airconsole.onMessage = function(from, message) {
          if (message.Type == "team")
          {
              setTeam(message.Data);
          }
          if (message.Type == "lock")
          {
              toggleVisibility("menu_controls", false);
              toggleVisibility("countdown_controls", true);
              toggleVisibility("game_controls", false);
          }
          if (message.Type == "countdown") {
              setCountdownTime(message.Data);
          }
          if (message.Type == "start")
          {
              toggleVisibility("menu_controls", false);
              toggleVisibility("countdown_controls", false);
              toggleVisibility("game_controls", true);
          }
      }
    }
	
	function togglePlayerReady() {
	    isPlayerReady = !isPlayerReady;
	    var playerReadyButton = document.getElementById("ready_button");
	    playerReadyButton.innerHTML = isPlayerReady ? "Ready" : "Not Ready";

	    airconsole.setCustomDeviceStateProperty('isPlayerReady', isPlayerReady);
	}

	function setTeam(team) {
	    playerTeam = team;

	    var teamText = document.getElementById("team_name");
	    teamText.innerHTML = playerTeam;
	}

	function setCountdownTime(time) {
	    var countdown = document.getElementById('countdown');
	    countdown.innerHTML = time;
	}

	function toggleVisibility(elementName, visible) {
	    var element = document.getElementById(elementName);
	    if (visible)
	        element.classList.remove('hidden');
	    else
	        element.classList.add('hidden');
	}

    </script>
    <style type="text/css">
        @font-face {
            font-family: 'Arial';
        }

        html, body {
            height: 100%;
            margin: 0px;
            font-family: 'PressStart2P', sans-serif;
            color: white;
            text-align: center;
            background-color: black;
        }

        .button {
            display: inline-block;
            height: 45%;
            width: 98%;
            background-color: #222;
            position: relative;
            color: #fff;
        }

        .inline-section > div {
            display: inline;
        }

        .hidden {
            display: none
        }
    </style>
</head>
<body onload="init()">
    <div id="menu_controls">
        <div style="height: 5%"></div>
        <button id="ready_button" class="button" ontouchstart="togglePlayerReady()" onmousedown="togglePlayerReady()">Not Ready</button>
        <div id="team_name">Unknown</div>
    </div>
    <div id="countdown_controls" class="hidden">
        <div style="height: 25%"></div>
        <div class="inline-section">
            <div>Game starts in </div>
            <div id="countdown"></div>
        </div>
    </div>
    <div id="game_controls" class="hidden">
        <div style="height: 25%"></div>
        <div>Controller goes here!</div>
    </div>
</body>
</html>